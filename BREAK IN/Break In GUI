-- ALL COPYRIGHT BELONGS TO ALEXROBLOX TM
-- GIB CREDIT PLS


-- LocalScript for the GUI creation and functionality

-- Reference to the ReplicatedStorage service
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RemoteEvents = ReplicatedStorage:WaitForChild("RemoteEvents")
local RunService = game:GetService("RunService")
local LocalPlayer = game.Players.LocalPlayer

-- Create the ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MyCustomGUI"
screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

-- Create the Frame
local frame = Instance.new("Frame")
frame.Name = "MainFrame"
frame.Size = UDim2.new(0.3, 0, 0.7, 0)  -- Adjusted height to fit all buttons
frame.Position = UDim2.new(0.35, 0, 0.15, 0)  -- Adjusted position to keep the frame in view
frame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
frame.Parent = screenGui

-- Create the Infinite Energy Button
local infEnergyButton = Instance.new("TextButton")
infEnergyButton.Name = "InfEnergyButton"
infEnergyButton.Size = UDim2.new(1, 0, 0.15, 0)
infEnergyButton.Position = UDim2.new(0, 0, 0.85, 0)
infEnergyButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
infEnergyButton.TextColor3 = Color3.fromRGB(0, 0, 0)
infEnergyButton.Text = "Infinite Energy"
infEnergyButton.Parent = frame

-- Create the Give Sword Button
local giveSwordButton = Instance.new("TextButton")
giveSwordButton.Name = "GiveSwordButton"
giveSwordButton.Size = UDim2.new(1, 0, 0.15, 0)
giveSwordButton.Position = UDim2.new(0, 0, 0.7, 0)
giveSwordButton.BackgroundColor3 = Color3.fromRGB(0, 0, 255)
giveSwordButton.TextColor3 = Color3.fromRGB(255, 255, 255)
giveSwordButton.Text = "Give Linked Sword"
giveSwordButton.Parent = frame

-- Create the Cat Befriend Button
local catBefriendButton = Instance.new("TextButton")
catBefriendButton.Name = "CatBefriendButton"
catBefriendButton.Size = UDim2.new(1, 0, 0.15, 0)
catBefriendButton.Position = UDim2.new(0, 0, 0.55, 0)
catBefriendButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
catBefriendButton.TextColor3 = Color3.fromRGB(255, 255, 255)
catBefriendButton.Text = "Cat Befriend"
catBefriendButton.Parent = frame

-- Create the Stealth Button
local stealthButton = Instance.new("TextButton")
stealthButton.Name = "StealthButton"
stealthButton.Size = UDim2.new(1, 0, 0.15, 0)
stealthButton.Position = UDim2.new(0, 0, 0.4, 0)
stealthButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0)
stealthButton.TextColor3 = Color3.fromRGB(0, 0, 0)
stealthButton.Text = "Stealth: OFF"
stealthButton.Parent = frame

-- Create the No-Clip Button
local noClipButton = Instance.new("TextButton")
noClipButton.Name = "NoClipButton"
noClipButton.Size = UDim2.new(1, 0, 0.15, 0)
noClipButton.Position = UDim2.new(0, 0, 0.25, 0)
noClipButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0)
noClipButton.TextColor3 = Color3.fromRGB(0, 0, 0)
noClipButton.Text = "No-Clip: OFF"
noClipButton.Parent = frame

-- Create the Pop-up Text
local popUpText = Instance.new("TextLabel")
popUpText.Name = "PopUpText"
popUpText.Size = UDim2.new(1, 0, 0.1, 0)
popUpText.Position = UDim2.new(0, 0, 0.1, 0)
popUpText.BackgroundColor3 = Color3.fromRGB(255, 255, 0)
popUpText.TextColor3 = Color3.fromRGB(0, 0, 0)
popUpText.Text = "YOU HAVE TO HAVE THE TEDDIE BEAR IN YOUR INVENTORY FOR THE STEALTH TO WORK."
popUpText.TextScaled = true
popUpText.TextWrap = true
popUpText.TextXAlignment = Enum.TextXAlignment.Center
popUpText.Visible = false
popUpText.Parent = frame

-- Create the Draggable Feature
local dragToggle = false
local dragInput, dragStart, startPos

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragToggle = true
        dragStart = input.Position
        startPos = frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragToggle = false
            end
        end)
    end
end)

frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement and dragToggle then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Variable to track if infinite energy is active
local infEnergyActive = false

-- Variable to track if stealth is active
local stealthActive = false

-- Variable to track if no-clip is active
local noClipEnabled = false

-- Function to handle infinite energy
local function onInfEnergyClicked()
    infEnergyActive = not infEnergyActive
    if infEnergyActive then
        infEnergyButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0) -- Red for active
        infEnergyButton.Text = "Infinite Energy: ON"
        -- Start the infinite energy loop
        while infEnergyActive do 
            local args = { [1] = "Cat" }
            RemoteEvents.Energy:FireServer(unpack(args))
            wait(0.1)  -- Short wait to prevent flooding
        end
    else
        infEnergyButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0) -- Green for inactive
        infEnergyButton.Text = "Infinite Energy: OFF"
    end
end

-- Function to handle giving the Linked Sword
local function onGiveSwordClicked()
    local args = { [1] = "LinkedSword" }
    RemoteEvents.GiveTool:FireServer(unpack(args))
end

-- Function to handle cat befriend
local function onCatBefriendClicked()
    RemoteEvents.Cattery:FireServer()
end

-- Function to handle stealth toggle
local function onStealthClicked()
    popUpText.Visible = true
    
    
    stealthActive = not stealthActive
    if stealthActive then
        stealthButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0) -- Green for active
        stealthButton.Text = "Stealth: ON"
        local args = { [1] = 13 }
        RemoteEvents.MakeStealth:FireServer(unpack(args))
    else
        stealthButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0) -- Orange for inactive
        stealthButton.Text = "Stealth: OFF"
        local args = { [1] = 0.05 }
        RemoteEvents.MakeStealth:FireServer(unpack(args))
    end
end

-- Function to handle no-clip toggle
local function onNoClipClicked()
    noClipEnabled = not noClipEnabled
    if noClipEnabled then
        noClipButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0) -- Green for active
        noClipButton.Text = "No-Clip: ON"
        RunService.Stepped:Connect(function()
            if noClipEnabled then
                for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
                    if v:IsA("BasePart") then
                        v.CanCollide = false
                    end
                end
            end
        end)
    else
        noClipButton.BackgroundColor3 = Color3.fromRGB(255, 165, 0) -- Orange for inactive
        noClipButton.Text = "No-Clip: OFF"
        for _, v in pairs(LocalPlayer.Character:GetDescendants()) do
            if v:IsA("BasePart") then
                v.CanCollide = true
            end
        end
    end
end

-- Connect the functions to the buttons
infEnergyButton.MouseButton1Click:Connect(onInfEnergyClicked)
giveSwordButton.MouseButton1Click:Connect(onGiveSwordClicked)
catBefriendButton.MouseButton1Click:Connect(onCatBefriendClicked)
stealthButton.MouseButton1Click:Connect(onStealthClicked)
noClipButton.MouseButton1Click:Connect(onNoClipClicked)

-- Make the frame draggable
frame.Active = true
frame.Draggable = true
frame.Selectable = false
